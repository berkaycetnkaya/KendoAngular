{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { ptItemToFormModel } from 'src/app/shared/models/forms';\nimport { ItemType, PT_ITEM_STATUSES, PT_ITEM_PRIORITIES } from 'src/app/core/constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core/state/app-store\";\nimport * as i2 from \"src/app/shared/services/modal.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../../../../../shared/components/modal-dialog/modal-dialog.component\";\n\nfunction PtItemDetailsComponent_option_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const itemType_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", itemType_r4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(itemType_r4);\n  }\n}\n\nfunction PtItemDetailsComponent_option_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const status_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", status_r5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(status_r5);\n  }\n}\n\nfunction PtItemDetailsComponent_option_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const priority_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", priority_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(priority_r6);\n  }\n}\n\nfunction PtItemDetailsComponent_li_52_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 22);\n    i0.ɵɵlistener(\"click\", function PtItemDetailsComponent_li_52_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const user_r7 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.selectUser(user_r7, \"custom-modal-1\"));\n    });\n    i0.ɵɵelementStart(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 23);\n    i0.ɵɵelement(4, \"img\", 24);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const user_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r7 == null ? null : user_r7.fullName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", user_r7 == null ? null : user_r7.avatar, i0.ɵɵsanitizeUrl);\n  }\n}\n\nexport class PtItemDetailsComponent {\n  constructor(store, modalService) {\n    this.store = store;\n    this.modalService = modalService;\n    this.itemSaved = new EventEmitter();\n    this.usersRequested = new EventEmitter();\n    this.users$ = this.store.select('users');\n    this.itemForm = ptItemToFormModel();\n    this.itemTypesProvider = ItemType.List.map(t => t.PtItemType);\n    this.statusesProvider = PT_ITEM_STATUSES;\n    this.prioritiesProvider = PT_ITEM_PRIORITIES;\n    this.closeResult = '';\n  }\n\n  ngOnInit() {\n    if (this.item) {\n      this.itemForm = ptItemToFormModel(this.item);\n      this.selectedTypeValue = this.itemForm.typeStr;\n      this.selectedPriorityValue = this.itemForm.priorityStr;\n      this.selectedAssignee = this.item.assignee;\n    }\n  }\n\n  onBlurTextField() {\n    this.notifyUpdateItem();\n  }\n\n  onDropdownChange() {\n    this.notifyUpdateItem();\n  }\n\n  assigneePickerOpen(id) {\n    this.usersRequested.emit();\n    this.openModal(id);\n  }\n\n  selectUser(selectedUser, id) {\n    if (typeof selectedUser === 'object' && this.itemForm) {\n      this.selectedAssignee = selectedUser;\n      this.itemForm.assigneeName = selectedUser.fullName;\n      this.notifyUpdateItem();\n    }\n\n    this.closeModal(id);\n  }\n\n  openModal(id) {\n    this.modalService.open(id);\n  }\n\n  closeModal(id) {\n    this.modalService.close(id);\n  }\n\n  notifyUpdateItem() {\n    const updatedItem = this.getUpdatedItem();\n    this.itemSaved.emit(updatedItem);\n  }\n\n  getUpdatedItem() {\n    if (!this.itemForm) {\n      return undefined;\n    }\n\n    const updatedItem = Object.assign({}, this.item, {\n      title: this.itemForm.title,\n      description: this.itemForm.description,\n      type: this.itemForm.typeStr,\n      status: this.itemForm.statusStr,\n      priority: this.itemForm.priorityStr,\n      estimate: this.itemForm.estimate,\n      assignee: this.selectedAssignee\n    });\n    return updatedItem;\n  }\n\n}\n\nPtItemDetailsComponent.ɵfac = function PtItemDetailsComponent_Factory(t) {\n  return new (t || PtItemDetailsComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.ModalService));\n};\n\nPtItemDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PtItemDetailsComponent,\n  selectors: [[\"app-item-details\"]],\n  inputs: {\n    item: \"item\"\n  },\n  outputs: {\n    itemSaved: \"itemSaved\",\n    usersRequested: \"usersRequested\"\n  },\n  decls: 55,\n  vars: 14,\n  consts: [[1, \"form-group\", \"row\"], [1, \"col-sm-2\", \"col-form-label\"], [1, \"col-sm-10\"], [\"name\", \"title\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [\"name\", \"description\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [\"name\", \"itemType\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"status\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"range\", \"step\", \"1\", \"min\", \"0\", \"max\", \"20\", \"name\", \"estimate\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"blur\"], [\"name\", \"priority\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"li-avatar\", \"rounded\", 3, \"src\"], [1, \"btn\", \"btn-sm\", \"btn-outline-secondary\", 3, \"click\"], [\"id\", \"custom-modal-1\"], [1, \"modal-header\"], [\"id\", \"modal-basic-title\", 1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [1, \"list-group\", \"list-group-flush\"], [\"class\", \"list-group-item d-flex justify-content-between align-items-center\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"modal-footer\"], [3, \"ngValue\"], [1, \"list-group-item\", \"d-flex\", \"justify-content-between\", \"align-items-center\", 3, \"click\"], [1, \"badge\"], [1, \"li-avatar\", \"rounded\", \"mx-auto\", \"d-block\", 3, \"src\"]],\n  template: function PtItemDetailsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\")(1, \"div\", 0)(2, \"label\", 1);\n      i0.ɵɵtext(3, \"Title\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"div\", 2)(5, \"input\", 3);\n      i0.ɵɵlistener(\"ngModelChange\", function PtItemDetailsComponent_Template_input_ngModelChange_5_listener($event) {\n        return ctx.itemForm.title = $event;\n      })(\"blur\", function PtItemDetailsComponent_Template_input_blur_5_listener() {\n        return ctx.onBlurTextField();\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(6, \"div\", 0)(7, \"label\", 1);\n      i0.ɵɵtext(8, \"Description\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"div\", 2)(10, \"textarea\", 4);\n      i0.ɵɵlistener(\"ngModelChange\", function PtItemDetailsComponent_Template_textarea_ngModelChange_10_listener($event) {\n        return ctx.itemForm.description = $event;\n      })(\"blur\", function PtItemDetailsComponent_Template_textarea_blur_10_listener() {\n        return ctx.onBlurTextField();\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(11, \"div\", 0)(12, \"label\", 1);\n      i0.ɵɵtext(13, \"Item Type\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"div\", 2)(15, \"select\", 5);\n      i0.ɵɵlistener(\"ngModelChange\", function PtItemDetailsComponent_Template_select_ngModelChange_15_listener($event) {\n        return ctx.itemForm.typeStr = $event;\n      })(\"ngModelChange\", function PtItemDetailsComponent_Template_select_ngModelChange_15_listener() {\n        return ctx.onDropdownChange();\n      });\n      i0.ɵɵtemplate(16, PtItemDetailsComponent_option_16_Template, 2, 2, \"option\", 6);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(17, \"div\", 0)(18, \"label\", 1);\n      i0.ɵɵtext(19, \"Status\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 2)(21, \"select\", 7);\n      i0.ɵɵlistener(\"ngModelChange\", function PtItemDetailsComponent_Template_select_ngModelChange_21_listener($event) {\n        return ctx.itemForm.statusStr = $event;\n      })(\"ngModelChange\", function PtItemDetailsComponent_Template_select_ngModelChange_21_listener() {\n        return ctx.onDropdownChange();\n      });\n      i0.ɵɵtemplate(22, PtItemDetailsComponent_option_22_Template, 2, 2, \"option\", 6);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(23, \"div\", 0)(24, \"label\", 1);\n      i0.ɵɵtext(25, \"Estimate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"div\", 2)(27, \"input\", 8);\n      i0.ɵɵlistener(\"ngModelChange\", function PtItemDetailsComponent_Template_input_ngModelChange_27_listener($event) {\n        return ctx.itemForm.estimate = $event;\n      })(\"blur\", function PtItemDetailsComponent_Template_input_blur_27_listener() {\n        return ctx.onBlurTextField();\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(28, \"div\", 0)(29, \"label\", 1);\n      i0.ɵɵtext(30, \"Priority\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"div\", 2)(32, \"select\", 9);\n      i0.ɵɵlistener(\"ngModelChange\", function PtItemDetailsComponent_Template_select_ngModelChange_32_listener($event) {\n        return ctx.itemForm.priorityStr = $event;\n      })(\"ngModelChange\", function PtItemDetailsComponent_Template_select_ngModelChange_32_listener() {\n        return ctx.onDropdownChange();\n      });\n      i0.ɵɵtemplate(33, PtItemDetailsComponent_option_33_Template, 2, 2, \"option\", 6);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(34, \"div\", 0)(35, \"label\", 1);\n      i0.ɵɵtext(36, \"Assignee\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(37, \"div\", 2);\n      i0.ɵɵelement(38, \"img\", 10);\n      i0.ɵɵelementStart(39, \"span\");\n      i0.ɵɵtext(40);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(41, \"button\", 11);\n      i0.ɵɵlistener(\"click\", function PtItemDetailsComponent_Template_button_click_41_listener() {\n        return ctx.assigneePickerOpen(\"custom-modal-1\");\n      });\n      i0.ɵɵtext(42, \"Pick assignee\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(43, \"custom-modal\", 12)(44, \"div\", 13)(45, \"h4\", 14);\n      i0.ɵɵtext(46, \"Select Assignee\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"button\", 15);\n      i0.ɵɵlistener(\"click\", function PtItemDetailsComponent_Template_button_click_47_listener() {\n        return ctx.closeModal(\"custom-modal-1\");\n      });\n      i0.ɵɵelementStart(48, \"span\", 16);\n      i0.ɵɵtext(49, \"\\u00D7\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(50, \"div\", 17)(51, \"ul\", 18);\n      i0.ɵɵtemplate(52, PtItemDetailsComponent_li_52_Template, 5, 2, \"li\", 19);\n      i0.ɵɵpipe(53, \"async\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(54, \"div\", 20);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.itemForm.title);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.itemForm.description);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.itemForm.typeStr);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.itemTypesProvider);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.itemForm.statusStr);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.statusesProvider);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.itemForm.estimate);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.itemForm.priorityStr);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.prioritiesProvider);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"src\", ctx.selectedAssignee == null ? null : ctx.selectedAssignee.avatar, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.itemForm.assigneeName);\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(53, 12, ctx.users$));\n    }\n  },\n  dependencies: [i3.NgForOf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.RangeValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.NgModel, i4.NgForm, i5.ModalComponent, i3.AsyncPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwdC1pdGVtLWRldGFpbHMuY29tcG9uZW50LmNzcyJ9 */\"],\n  changeDetection: 0\n});","map":{"version":3,"mappings":"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","names":["EventEmitter","ptItemToFormModel","ItemType","PT_ITEM_STATUSES","PT_ITEM_PRIORITIES","i0","PtItemDetailsComponent","constructor","store","modalService","select","List","map","t","PtItemType","ngOnInit","item","itemForm","selectedTypeValue","typeStr","selectedPriorityValue","priorityStr","selectedAssignee","assignee","onBlurTextField","notifyUpdateItem","onDropdownChange","assigneePickerOpen","id","usersRequested","emit","openModal","selectUser","selectedUser","assigneeName","fullName","closeModal","open","close","updatedItem","getUpdatedItem","itemSaved","undefined","Object","assign","title","description","type","status","statusStr","priority","estimate","selectors","inputs","outputs","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\eğitim\\KendoRPS\\rpstrackerng\\src\\app\\modules\\backlog\\components\\detail\\item-details\\pt-item-details.component.ts","C:\\eğitim\\KendoRPS\\rpstrackerng\\src\\app\\modules\\backlog\\components\\detail\\item-details\\pt-item-details.component.html"],"sourcesContent":["import { Component, OnInit, Input, ChangeDetectionStrategy, EventEmitter, Output } from '@angular/core';\r\n\r\nimport { PtItem, PtUser } from 'src/app/core/models/domain';\r\nimport { PtItemDetailsEditFormModel, ptItemToFormModel } from 'src/app/shared/models/forms';\r\nimport { PtItemType } from 'src/app/core/models/domain/types';\r\nimport { PriorityEnum } from 'src/app/core/models/domain/enums';\r\nimport { ItemType, PT_ITEM_STATUSES, PT_ITEM_PRIORITIES } from 'src/app/core/constants';\r\nimport { Observable } from 'rxjs';\r\nimport { Store } from 'src/app/core/state/app-store';\r\nimport { ModalService } from 'src/app/shared/services/modal.service';\r\n\r\n@Component({\r\n    selector: 'app-item-details',\r\n    templateUrl: 'pt-item-details.component.html',\r\n    styleUrls: ['pt-item-details.component.css'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class PtItemDetailsComponent implements OnInit {\r\n\r\n    @Input() item: PtItem | undefined;\r\n    @Output() itemSaved = new EventEmitter<PtItem>();\r\n    @Output() usersRequested = new EventEmitter<string>();\r\n\r\n    public users$: Observable<PtUser[]> = this.store.select<PtUser[]>('users');\r\n\r\n    private selectedTypeValue: PtItemType | undefined;\r\n    private selectedPriorityValue: PriorityEnum | undefined;\r\n    public selectedAssignee: PtUser | undefined;\r\n\r\n    public itemForm: PtItemDetailsEditFormModel = ptItemToFormModel();\r\n    public itemTypesProvider = ItemType.List.map((t) => t.PtItemType);\r\n    public statusesProvider = PT_ITEM_STATUSES;\r\n    public prioritiesProvider = PT_ITEM_PRIORITIES;\r\n\r\n    closeResult = '';\r\n\r\n    constructor(\r\n        private store: Store,\r\n        private modalService: ModalService,\r\n    ) { }\r\n\r\n    public ngOnInit() {\r\n        if (this.item) {\r\n            this.itemForm = ptItemToFormModel(this.item);\r\n            this.selectedTypeValue = <PtItemType>this.itemForm.typeStr;\r\n            this.selectedPriorityValue = <PriorityEnum>this.itemForm.priorityStr;\r\n            this.selectedAssignee = this.item.assignee;\r\n        }\r\n    }\r\n\r\n    public onBlurTextField() {\r\n        this.notifyUpdateItem();\r\n    }\r\n\r\n    public onDropdownChange() {\r\n        this.notifyUpdateItem();\r\n    }\r\n\r\n    public assigneePickerOpen(id: string) {\r\n        this.usersRequested.emit();\r\n        this.openModal(id);\r\n    }\r\n\r\n    public selectUser(selectedUser: PtUser, id: string) {\r\n        if (typeof selectedUser === 'object' && this.itemForm) {\r\n            this.selectedAssignee = selectedUser;\r\n            this.itemForm.assigneeName = (selectedUser as PtUser).fullName;\r\n            this.notifyUpdateItem();\r\n        }\r\n        this.closeModal(id);\r\n    }\r\n\r\n    openModal(id: string) {\r\n        this.modalService.open(id);\r\n    }\r\n\r\n    closeModal(id: string) {\r\n        this.modalService.close(id);\r\n    }\r\n\r\n    private notifyUpdateItem() {\r\n        const updatedItem = this.getUpdatedItem();\r\n        this.itemSaved.emit(updatedItem);\r\n    }\r\n\r\n    private getUpdatedItem(): PtItem | undefined {\r\n\r\n        if (!this.itemForm) {\r\n            return undefined;\r\n        }\r\n        const updatedItem = Object.assign({}, this.item, {\r\n            title: this.itemForm.title,\r\n            description: this.itemForm.description,\r\n            type: this.itemForm.typeStr,\r\n            status: this.itemForm.statusStr,\r\n            priority: this.itemForm.priorityStr,\r\n            estimate: this.itemForm.estimate,\r\n            assignee: this.selectedAssignee\r\n        });\r\n        return updatedItem;\r\n    }\r\n\r\n\r\n}\r\n","<form>\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Title</label>\r\n        <div class=\"col-sm-10\">\r\n            <input class=\"form-control\" [(ngModel)]=\"itemForm.title\" (blur)=\"onBlurTextField()\" name=\"title\" />\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Description</label>\r\n        <div class=\"col-sm-10\">\r\n            <textarea class=\"form-control\" [(ngModel)]=\"itemForm.description\" (blur)=\"onBlurTextField()\" name=\"description\"></textarea>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Item Type</label>\r\n        <div class=\"col-sm-10\">\r\n            <select class=\"form-control\" [(ngModel)]=\"itemForm.typeStr\" (ngModelChange)=\"onDropdownChange()\" name=\"itemType\">\r\n                <option *ngFor=\"let itemType of itemTypesProvider\" [ngValue]=\"itemType\">{{itemType}}</option>\r\n            </select>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Status</label>\r\n        <div class=\"col-sm-10\">\r\n            <select class=\"form-control\" [(ngModel)]=\"itemForm.statusStr\" (ngModelChange)=\"onDropdownChange()\" name=\"status\">\r\n                <option *ngFor=\"let status of statusesProvider\" [ngValue]=\"status\">{{status}}</option>\r\n            </select>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Estimate</label>\r\n        <div class=\"col-sm-10\">\r\n            <input class=\"form-control\" type=\"range\" step=\"1\" min=\"0\" max=\"20\" [(ngModel)]=\"itemForm.estimate\" (blur)=\"onBlurTextField()\"\r\n                name=\"estimate\" />\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Priority</label>\r\n        <div class=\"col-sm-10\">\r\n            <select class=\"form-control\" [(ngModel)]=\"itemForm.priorityStr\" (ngModelChange)=\"onDropdownChange()\" name=\"priority\">\r\n                <option *ngFor=\"let priority of prioritiesProvider\" [ngValue]=\"priority\">{{priority}}</option>\r\n            </select>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"form-group row\">\r\n        <label class=\"col-sm-2 col-form-label\">Assignee</label>\r\n\r\n        <div class=\"col-sm-10\">\r\n            <img [src]=\"selectedAssignee?.avatar\" class=\"li-avatar rounded\" />\r\n            <span>{{ itemForm.assigneeName }}</span>\r\n\r\n            <button class=\"btn btn-sm btn-outline-secondary\" (click)=\"assigneePickerOpen('custom-modal-1')\">Pick assignee</button>\r\n        </div>\r\n    </div>\r\n</form>\r\n\r\n\r\n<custom-modal id=\"custom-modal-1\">\r\n    <div class=\"modal-header\">\r\n        <h4 class=\"modal-title\" id=\"modal-basic-title\">Select Assignee</h4>\r\n        <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"closeModal('custom-modal-1')\">\r\n            <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n    </div>\r\n    <div class=\"modal-body\">\r\n        <ul class=\"list-group list-group-flush\">\r\n            <li *ngFor=\"let user of users$ | async\" class=\"list-group-item d-flex justify-content-between align-items-center\"\r\n                (click)=\"selectUser(user, 'custom-modal-1')\">\r\n                <span>{{ user?.fullName }}</span>\r\n                <span class=\"badge \">\r\n                    <img [src]=\"user?.avatar\" class=\"li-avatar rounded mx-auto d-block\" />\r\n                </span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class=\"modal-footer\">\r\n\r\n    </div>\r\n</custom-modal>\r\n"]},"metadata":{},"sourceType":"module"}